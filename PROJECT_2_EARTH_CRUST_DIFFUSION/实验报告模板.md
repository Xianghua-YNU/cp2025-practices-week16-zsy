# 项目2：地壳热扩散数值模拟 - 实验报告

**学生姓名：** [朱思宇]

**学号：** [20221170050]

**完成日期：** [2025.6.13]


---

## 1. 实验目的

本实验旨在通过数值方法求解地壳中的热传导方程，深入理解以下概念：

- 时变边界条件对热传导过程的影响
- 显式差分格式的稳定性和精度特点
- 地球科学中的热传导现象

**核心学习目标：**
1. 掌握显式差分格式求解抛物型偏微分方程
2. 理解季节性温度变化在地壳中的传播规律

---

## 2. 理论背景

### 2.1 热传导方程

地壳中的一维热传导方程为：

$$\frac{\partial T}{\partial t} = D \frac{\partial^2 T}{\partial z^2}$$

其中：
- $T(z,t)$ 是温度分布函数
- $z$ 是深度坐标（向下为正）
- $t$ 是时间
- $D$ 是热扩散率

### 2.2 边界条件和初始条件

**边界条件：**
- 地表 ( $z=0$ )： $T(0,t) = A + B\sin(\frac{2\pi t}{\tau})$
- 深层 ( $z=20\text{m}$ )： $T(20,t) = 11°\text{C}$

**初始条件：**
- $T(z,0) = 10°\text{C}$ （除边界点外）

**物理参数：**
- $D = 0.1 \text{ m}^2/\text{day}$ （热扩散率）
- $A = 10°\text{C}$ （年平均地表温度）
- $B = 12°\text{C}$ （地表温度振幅）
- $\tau = 365 \text{ days}$ （年周期）


## 3. 数值方法简述

### 3.1 显式差分格式(或者你采取的其他算法)

**请描述你实现的差分算法的具体形式和求解方法：**

[使用显式差分格式，将时间和深度离散化，深度步长为 dz，时间步长为 dt。![1749744767585](https://github.com/user-attachments/assets/712502bd-9ac3-4753-8554-f436858b5ca4)
上边界（地表）应用时变温度条件![1749744786518](https://github.com/user-attachments/assets/7a6447ae-a360-4ac4-8f7d-bfaf7f62e904)
下边界（20米深处）固定温度 T_n_z-1^t=11°C。显式差分格式要求稳定性参数 r≤0.5，以确保模拟的稳定性。]
- 空间和时间离散化方案
- 差分方程的具体形式
- 边界条件的处理方法
- 稳定性条件的考虑

**稳定性分析：**

[稳定性参数 r= hD/a^2的值:h=dt 是时间步长,a=dz 是深度步长r=D⋅ dt/dz^2必须小于或等于0.5，以确保模拟稳定。
时间步长选择的限制条件： 时间步长 dt 必须足够小，以满足 r≤0.5。]
- 稳定性参数 $r = \frac{hD}{a^2}$ 的值
- 时间步长选择的限制条件

---

## 4. 实验结果

### 4.1 数值结果

**基本计算参数：**
- 网格点数: $n_z$ =  [400]
- 时间步数: $n_t$ =  [36500]
- 模拟总时间：[10] 年
- 稳定性参数: $r$ =  [0.498]

### 4.2 图表结果：季节性温度轮廓图

[![1749804503583](https://github.com/user-attachments/assets/6a10989e-4392-4ea9-a8fd-5713da051859)
]

**图表分析：**
- 描述四个季节温度轮廓的差异[ 在地表附近（浅层），不同季节的温度差异显著；随着深度增加，温度差异逐渐减小，在深层（约10米以下），不同季节的温度曲线趋于重合。]
- 分析温度振幅随深度的衰减规律[ 温度振幅随深度呈指数衰减。地表温度振幅为12°C，但在约10米深处，温度振幅已显著减小，几乎不再变化。]
- 讨论季节性影响的穿透深度[季节性温度变化的影响主要集中在地表附近的浅层区域（约5米内）。在约10米深处，季节性温度变化的影响已基本消失。]

---

## 5. 分析与讨论

### 5.1 物理现象分析

**地壳热传导特征：**

[季节性温度变化主要影响地表附近的浅层区域，随着深度增加，温度波动迅速衰减。地壳的热惯性导致深层温度变化滞后于地表温度变化，形成相位延迟。地壳的热扩散率较低，使得温度波在深层的传播较慢。]


### 5.4 思考题

**请回答以下问题：**

1. **为什么深层温度的季节性变化比地表小得多？这种现象在实际地球科学中有什么应用？**

   [地壳的热扩散率较低，导致温度波在传播过程中能量迅速衰减。此外，地壳的热惯性较大，使得深层温度变化滞后且幅度减小。现象可用于地下热储层的开发利用，例如地热能的提取。在较深地层中，温度变化较小，可提供相对稳定的热源。]

3. **显式差分格式相比隐式格式有什么优势？在什么情况下可能选择隐式格式？**

   [显式格式的优势： 显式格式计算简单，易于实现，适合处理短期模拟问题。隐式格式的选择： 隐式格式具有更好的稳定性，适合处理长期模拟或需要较大时间步长的情况。但在这种情况下，需要解线性方程组，计算复杂度较高。]

---

## 6. 核心代码片段（可选）

```python
# 在此粘贴你实现的核心求解算法
def solve_earth_crust_diffusion():
  
    # 网格参数（调整后的参数）
    n_z = 400  # 增加深度方向网格点数（减少dz）
    n_t = 365 * 10 * 10  # 增加时间步数（减少dt），模拟10年，时间步长更小

    dz = depth_max / (n_z - 1)  # 深度步长(m)
    dt = tau / (n_t - 1)  # 时间步长(天)
    r = D * dt / dz**2
    if r > 0.5:
        print(f"警告：稳定性参数 r={r:.4f} 超过0.5，模拟可能不稳定")
        # 返回空数组以避免解包错误
        return np.array([]), np.array([])

    depth_array = np.linspace(0, depth_max, n_z)
    temperature_matrix = np.zeros((n_z, n_t))

    temperature_matrix[:, 0] = T_bottom

    for t in range(1, n_t):
        time = t * dt 

        T_surface = A + B * np.sin(2 * np.pi * time / tau)
       
        temperature_matrix[0, t] = T_surface
 
        temperature_matrix[-1, t] = T_bottom
    
        for i in range(1, n_z - 1):
            temperature_matrix[i, t] = temperature_matrix[i, t-1] + r * (temperature_matrix[i+1, t-1] - 2 * temperature_matrix[i, t-1] + temperature_matrix[i-1, t-1])

    return depth_array, temperature_matrix
```

